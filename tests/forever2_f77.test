#!/bin/sh

# Test (within reasonable limits) that `for(;;)' originates an
# infinite loop.

. ../lib/rat4-t.sh || exit 99

require_fortran_compiler

cat > tst.r <<EOF
program testforever2
    integer i
    i = 0
    for(;;) {
        i = i + 1
    }
    write(*,10) i
10  format(I50)
    call halt
end
EOF

cat tst.r

run_RATFOR tst.r || testcase_FATAL_FAILURE
mv stdout tst.f
run_F77 tst.f || testcase_FATAL_FAILURE
# 254 means "timeout error"
run_command -e 254 timer -t 15 ./tst.exe || testcase_FATAL_FAILURE
test -s stdout && testcase_FATAL_FAILURE

testcase_PASS

# vim: ft=sh ts=4 sw=4 et
