#!/bin/sh

# Check that ratfor honors the user's choiche of internal starting label
# (see `-l' option)

. ../lib/rat4-t.sh || exit 99

cat >tst.r <<EOF
while(true) {
    do_nothing()
}
EOF

run_RATFOR -l 100 tst.r || testcase_FATAL_FAILURE
$GREP -v '^[cC]' stdout >stdout1
$GREP '^100 ' stdout1 || testcase_FATAL_FAILURE
$EGREP -v '^( |10[0-9])' stdout2 && testcase_FATAL_FAILURE

run_RATFOR -l 60000 tst.r || testcase_FATAL_FAILURE
$GREP -v '^[cC]' stdout >stdout2
$GREP '^60000 ' stdout2 || testcase_FATAL_FAILURE
$EGREP -v '^( |6000[0-9])' stdout2 && testcase_FATAL_FAILURE

testcase_PASS

# vim: ft=sh ts=4 sw=4 et
