#!/bin/sh

# Check that line numbers in error messages are ok

. ../lib/rat4-t.sh || exit 99

echo '}' > tst1.r
run_RATFOR -e 1 tst1.r || testcase_FATAL_FAILURE
mv stderr stderr1
$FGREP 'tst1.r:1:' stderr1 || testcase_FATAL_FAILURE

cat > tst2.r <<EOF
#1
} #2
#3
#4
} #5
#6
EOF
run_RATFOR -e 1 tst2.r || testcase_FATAL_FAILURE
mv stderr stderr2
$FGREP 'tst2.r:2:' stderr2 || testcase_FATAL_FAILURE
$FGREP 'tst2.r:5:' stderr2 || testcase_FATAL_FAILURE

cat > tst3.r <<EOF
{ #1
#2
#3
EOF

run_RATFOR -e 1 tst3.r || testcase_FATAL_FAILURE
mv stderr stderr3
# unexpected EOF in input
$FGREP 'tst3.r:3:' stderr3 || testcase_FATAL_FAILURE

testcase_DONE

# vim: ft=sh ts=4 sw=4 et
