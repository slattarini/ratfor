#!/bin/sh

# Check that the `include' statement abort ratofor on recursive inclusion.

. ./defs.sh || exit 99

cat > foo.r <<EOF
include bar.r
EOF

cat > bar.r <<EOF
include foo.r
EOF

timer 15 run_RATFOR -e 1 foo.r || :

case `cat 'timer-exitstatus'` in
  0) if test -s stderr; then
        testcase_PASS
    else
        testcase_FAIL "ratfor did not print error any message on" \
                      "recursive include"
    fi
    ;;
  1)
    testcase_FAIL "ratfor succceded on recursive include"
    ;;
  TIMEOUT)
    testcase_FAIL "ratfor hanged on recursive include"
    ;;
  *)
    testcase_HARDERROR "unexpected exit status value from run_RATFOR()"
    ;;
esac

# vim: ft=sh ts=4 sw=4 et
