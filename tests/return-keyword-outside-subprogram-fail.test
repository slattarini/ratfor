#!/bin/sh

# Check that ratfor give proper error messages if `return' is used outside
# any subprogram (function or subroutine).

. ./TestsAux/defs.sh || exit 99

i=0
errmsg="return statement outside any function or subroutine"
for input in \
    'return' \
    'return x'  \
    'return(1)' \
    '{ return }' \
    '{ return x }' \
    '{ return(1) }' \
    "$NEWLINE; pass; pass; return x" \
    "${NEWLINE}; pass; pass${NEWLINE}${NEWLINE}pass; return" \
    'function foo; pass; end; return' \
    'subroutine bar; pass; end; return' \
; do
    i=`expr $i + 1`
    echo "$input" >$i-tst.r
    run_RATFOR -e 1 $i-tst.r || testcase_FAIL
    mv stderr $i-stderr
    mv stdout $i-stdout
    $GREP "$errmsg" $i-stderr || testcase_FAIL
done

testcase_PASS

# vim: ft=sh ts=4 sw=4 et
