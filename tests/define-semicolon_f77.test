#!/bin/sh

# Check that `define(SYM, VALUE)' works if VALUE contains semicolons.

. ./defs.sh || exit 99

require_fortran_compiler

cat >tst.r <<EOF
  define(stmt1, a = 1; b = 2; c = 3;)
  define(stmt2, d = 4; ;;e = 5)
  program testprogram
    implicit none
    integer a, b, c, d, e
    stmt1
    stmt2
    write(*,100) a
    write(*,100) b
    write(*,100) c
    write(*,100) d
    write(*,100) e
100 format(I1)
    stop
  end # testprogram
EOF

cat >exp <<EOF
1
2
3
4
5
EOF

run_CMD "$RATFOR" tst.r || testcase_FAIL
mv stdout tst.f
run_CMD $F77 -o tst.exe tst.f || testcase_FAIL
run_CMD ./tst.exe || testcase_FAIL
mv stdout got
test -s stderr && testcase_FAIL
$DIFF_U exp got || testcase_FAIL

testcase_PASS

# vim: ft=sh ts=4 sw=4 et
