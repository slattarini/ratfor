#!/bin/sh

# Check that `define(SYM, VALUE)' works if VALUE contains semicolons.

. ../lib/rat4-t.sh || exit 99

require_fortran_compiler

cat >tst.r <<EOF
  define(stmt1, a = 1; b = 2; c = 3;)
  define(stmt2, d = 4; ;;e = 5)
  program testprogram
    implicit none
    integer a, b, c, d, e
    stmt1
    stmt2
    write(*,100) a
    write(*,100) b
    write(*,100) c
    write(*,100) d
    write(*,100) e
100 format(I1)
    call halt
  end # testprogram
EOF

cat >exp <<EOF
1
2
3
4
5
EOF

run_RATFOR tst.r || testcase_FATAL_FAILURE
mv stdout tst.f
run_F77 tst.f || testcase_FATAL_FAILURE
run_command ./tst.exe || testcase_FATAL_FAILURE
mv stdout got
test -s stderr && testcase_FATAL_FAILURE
$DIFF_U exp got || testcase_FATAL_FAILURE

testcase_PASS

# vim: ft=sh ts=4 sw=4 et
