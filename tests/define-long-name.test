#!/bin/sh

# Check the the `define' builtin deal gracefully with long macro names.

. ../lib/rat4-t.sh || exit 99

sym='WOWThisTrulyIsAVeryVeryVERYLongNameForSuchAnIncrediblySimpleMacro'
x1='xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx1'
x2='xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx2'

cat >tst.r <<EOF
define $sym short
define $x1  y1
define $x2  y2
$sym
$x1
$x2
EOF

cat >exp <<EOF
short
y1
y2
EOF

cat tst.r

run_RATFOR tst.r || testcase_FAIL
test -s stderr && testcase_FAIL
$SED -e '/^[cC]/d' -e "s/^$ws0p//" -e '/^$/d' stdout >got

cat exp
cat got

$DIFF_U exp got || testcase_FAIL

testcase_PASS

# vim: ft=sh ts=4 sw=4 et
