#!/bin/sh

# Check that ratfor does not unnecessarily overwrite files when multiple
# `-o' options are given

. ../lib/rat4-testsuite-init.sh || exit 99

mkdir out.d

echo 'clobbered' > tst.r
echo 'safe' > safe
cp safe o1
cp safe o2
cp safe o3

run_RATFOR -o o1 -o o2 -o o3 tst.r || testcase_FAIL
test -s stderr && testcase_FAIL

set +x
(set -x; $DIFF_U o1 safe) || { echo '~~~~~'; testcase_FAIL; }
(set -x; $DIFF_U o2 safe) || { echo '~~~~~'; testcase_FAIL; }
set -x

$GREP clobbered o3 || testcase_FAIL

testcase_DONE

# vim: ft=sh ts=4 sw=4 et
