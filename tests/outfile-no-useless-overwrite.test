#!/bin/sh

# Check that ratfor does not overwrite its output file if the opening of
# the input file fails.

. ../lib/rat4-t.sh || exit 99

mkdir tst.out
echo 'saved' > safe
cp safe risky

test ! -f none.r

run_RATFOR -e 1 -- -o risky none.r || testcase_FATAL_FAILURE
cat risky
$DIFF_U safe risky || {
    (echo '~~~~~') 2>/dev/null # redirect to disable traces
    testcase_FATAL_FAILURE
}

testcase_DONE

# vim: ft=sh ts=4 sw=4 et
